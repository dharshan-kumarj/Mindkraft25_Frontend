<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Event Tiles</title>
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    rel="stylesheet"
  />
  <style>
    /* General Styles */
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
      background: #0f172a url('assets/images/bg.png') no-repeat center center fixed; /* Dark background with image */
      background-size: cover;
      color: #f8fafc; /* Light text */
    }

    /* Side Navigation Bar */
    .side-nav {
      width: 250px;
      height: 100vh;
      background-color: rgba(30, 41, 59, 0.9); /* Semi-transparent dark background */
      position: fixed;
      top: 0;
      left: -250px; /* Initially hidden */
      padding-top: 100px; /* To account for the header */
      overflow-y: auto;
      z-index: 999;
      transition: left 0.3s ease;
    }

    .side-nav.open {
      left: 0; /* Show the side nav */
    }

    .side-nav ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .side-nav ul li {
      padding: 15px 20px;
      color: #f8fafc; /* Light text */
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .side-nav ul li:hover {
      background-color: rgba(51, 65, 85, 0.8); /* Semi-transparent dark hover background */
    }

    .side-nav ul li.active {
      background-color: rgba(51, 65, 85, 0.8); /* Semi-transparent dark active background */
    }

    /* Hamburger Menu */
    .hamburger-menu {
      position: fixed;
      top: 30px;
      left: 20px;
      font-size: 24px;
      color: #f8fafc;
      cursor: pointer;
      z-index: 1001;
    }

    /* Header Styles */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100px;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      /* background-color: rgba(15, 23, 42, 0.8); Semi-transparent header */
    }

    .header img {
      position: absolute;
      left: 50px;
      height: 80px;
      width: 80px;
      object-fit: cover;
      border-radius: 50%;
    }

    .header-title {
      font-size: 24px;
      font-weight: bold;
      text-transform: uppercase;
      color: aliceblue;
    }

    /* View Cart Button */
    .view-cart-button {
      position: absolute;
      right: 20px;
      padding: 12px 24px;
      font-size: 16px;
      font-weight: 600;
      color: white;
      background: linear-gradient(45deg, #6a11cb, #2575fc); /* Gradient background */
      border: none;
      border-radius: 50px;
      cursor: pointer;
      overflow: hidden;
      transition: all 0.4s ease;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .view-cart-button:hover {
      background: linear-gradient(45deg, #2575fc, #6a11cb); /* Reverse gradient on hover */
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    }

    .view-cart-button:active {
      transform: translateY(0);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    /* Container for Event Tiles */
    .event-container {
      padding-top: 120px;
      padding-left: 90px; /* Adjusted for side nav */
      display: flex;
      justify-content: flex-start;
      align-items: flex-start;
      flex-wrap: wrap;
      gap: 20px;
      transition: padding-left 0.3s ease;
    }

    .event-container.side-nav-open {
      padding-left: 400px; /* Adjusted for open side nav */
    }

    /* Event Tile Styles */
    .event-tile {
      width: 350px; /* Fixed width */
      height: 250px; /* Fixed height */
      background-color: rgba(30, 41, 59, 极客时间 0.5); /* Translucent background */
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      text-align: center;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      padding: 16px;
      display:极客时间 flex;
      flex-direction: column;
      justify-content: space-between;
      border: 2px solid rgba(255, 255, 255, 0.1); /* Light border for visibility */
    }

    .event-tile:hover {
      transform: translateY(-10px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
    }

    .details h2 {
      margin: 0;
      font-size: 20px;
      font-weight: bold;
      color: #f8fafc; /* Light text */
    }

    .chips {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin: 16px 0;
    }

    .chips span {
      background-color: rgba(51, 65, 85, 0.8); /* Semi-transparent dark chip background */
      border-radius: 16px;
      padding: 8px 12px;
      margin: 4px;
      font-size: 14px;
      color: #f8fafc; /* Light text */
      display: flex;
      align-items: center;
    }

    .chips span i {
      margin-right: 6px;
    }

    /* Register Button Style */
    .register-button {
      width: 48%; /* Adjusted width to fit side by side */
      padding: 12px 24px;
      font-size: 16px;
      font-weight: 600;
      color: white;
      background: linear-gradient(45deg, #7952B3, #4b10a4); /* Gradient background */
      border: none;
      border-radius: 50px;
      cursor: pointer;
      overflow: hidden;
      position: relative;
      transition: all 0.4s ease;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .register-button:hover {
      background: linear-gradient(45deg, #7952B3, #4b10a4); /* Reverse gradient on hover */
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 极客时间 0, 0.3);
    }

    .register-button:active {
      transform: translateY(0);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    /* Back to Events Button Style */
    .back-button {
      width: 48%; /* Adjusted width to fit side by side */
      padding: 12px 24px;
      font-size: 16px;
      font-weight: 600;
      color: white;
      background: linear-gradient(45deg, #6a11cb, #2575fc); /* Gradient background */
      border: none;
      border-radius: 50px;
      cursor: pointer;
      overflow: hidden;
      position: relative;
      transition: all 0.4s ease;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .back-button:hover {
      background: linear-gradient(45deg, #2575fc, #6a11cb); /* Reverse gradient on hover */
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    }

    .back-button:active {
      transform: translateY(0);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    /* Button Container */
    .button-container {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }

    /* Event Details Section */
    .event-details {
      display: none;
      width: 80%;
      max-width: 600px;
      margin: 120px auto 20px;
      background-color: rgba(30, 41, 59, 0.9); /* Semi-transparent dark card background */
      border-radius: 12px;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      padding: 20px;
      text-align: left;
    }

    .event-details h2 {
      font-size: 24px;
      margin-bottom: 16px;
      color: #f8fafc; /* Light text */
    }

    .event-details p {
      font-size: 16px;
      margin: 8px 0;
      color: #f8fafc; /* Light text */
    }

    /* Loading Spinner */
    .loading-spinner {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 24px;
      color: #f8fafc;
    }
  </style>
</head>
<body>
  <!-- Hamburger Menu -->
  <div class="hamburger-menu" onclick="toggleSideNav()">
    <i class="fas fa-bars"></i>
  </div>

  <!-- Side Navigation Bar -->
  <div class="side-nav">
    <ul>
      <li class="active" onclick="filterEvents('all')">All Departments</li>
      <li onclick="filterEvents('Physical Sciences')">Physical Sciences</li>
      <li onclick="filterEvents('AIML')">AIML</li>
      <li onclick="filterEvents('Physical Science')">Physical Science</li>
      <li onclick="filterEvents('Physical Science (Chemistry)')">Physical Science (Chemistry)</li>
      <li onclick="filterEvents('Food Processing Technology')">Food Processing Technology</li>
      <li onclick="filterEvents('Karunya School of Management')">Karunya School of Management</li>
      <li onclick="filterEvents('Computer Science and Engineering')">Computer Science and Engineering</li>
      <li onclick="filterEvents('English')">English</li>
      <li onclick="filterEvents('Civil Engineering')">Civil Engineering</li>
      <li onclick="filterEvents('Commerce and International Trade')">Commerce and International Trade</li>
      <li onclick="filterEvents('Data Science and Cyber Security')">Data Science and Cyber Security</li>
      <li onclick="filterEvents('MECHANICAL')">MECHANICAL</li>
      <li onclick="filterEvents('MEDIA')">MEDIA</li>
      <li onclick="filterEvents('Mechanical')">Mechanical</li>
      <li onclick="filterEvents('Robotics Engineering')">Robotics Engineering</li>
      <li onclick="filterEvents('Biomedical Engineering')">Biomedical Engineering</li>
      <li onclick="filterEvents('Division of Criminology and Forensic Science')">Division of Criminology and Forensic Science</li>
      <li onclick="filterEvents('Digital Sciences')">Digital Sciences</li>
      <li onclick="filterEvents('Aerospace Engineering')">Aerospace Engineering</li>
      <li onclick="filterEvents('Division of Civil Engineering')">Division of Civil Engineering</li>
    </ul>
  </div>

  <!-- Header Section -->
  <div class="header">
    <img src="assets/images/karunyalogo.png" alt="Left Logo">
    <h1 class="header-title">MINDKRAFT 2K25</h1>
    <button class="view-cart-button" onclick="window.location.href='cart.html'">
      View Cart
    </button>
  </div>

  <!-- Event Tiles Container -->
  <div class="event-container">
    <!-- Event tiles will be inserted here by JavaScript -->
  </div>

  <!-- Event Details Section -->
  <div class="event-details">
    <h2>Event Title</h2>
    <p><strong>Description:</strong> <span id="event-description"></span></p>
    <p><strong>Prizes:</strong> <span id="event-prizes"></span></p>
    <p><strong>Student Coordinator:</strong> <span id="student-coordinator"></span></p>
    <p><strong>Staff Coordinator:</strong> <span id="staff-coordinator"></span></p>
    <p><strong>Contact Number:</strong> <span id="contact-number"></span></p>
    <div class="button-container">
      <button class="back-button" onclick="hideEventDetails()">
        Back to Events
      </button>
      <button class="register-button" id="register-button">
        Register Now
      </button>
    </div>
  </div>

  <!-- Loading Spinner -->
  <div class="loading-spinner" id="loading-spinner">
    <i class="fas fa-spinner fa-spin"></i>
  </div>

  <script>
    // Function to toggle the side navigation bar
    function toggleSideNav() {
      const sideNav = document.querySelector('.side-nav');
      const eventContainer = document.querySelector('.event-container');
      sideNav.classList.toggle('open');
      eventContainer.classList.toggle('side-nav-open');
    }

    // Fetch events from the API
    async function fetchEvents(filter = 'all') {
      const loadingSpinner = document.getElementById('loading-spinner');
      loadingSpinner.style.display = 'block';

      try {
        let url = 'https://mindkraft25-backend.onrender.com/api/events/';
        if (filter !== 'all') {
          url = `https://mindkraft25-backend.onrender.com/api/events/filter/?division=${encodeURIComponent(filter)}`;
        }

        const response = await fetch(url);
        const data = await response.json();

        if (data.status === 'success') {
          generateEventTiles(data.data);
        } else {
          alert('Failed to fetch events');
        }
      } catch (error) {
        console.error('Error fetching events:', error);
        alert('An error occurred while fetching events.');
      } finally {
        loadingSpinner.style.display = 'none';
      }
    }

    // Function to generate event tiles
    function generateEventTiles(events) {
      const container = document.querySelector('.event-container');
      container.innerHTML = ''; // Clear existing tiles

      events.forEach(event => {
        const eventTile = document.createElement('div');
        eventTile.className = 'event-tile';

        eventTile.innerHTML = `
          <div class="details">
            <h2>${event.eventname}</h2>
            <div class="chips">
              <span><i class="fas fa-calendar-alt"></i> ${formatDate(event.start_time)}</span>
              <span><i class="fas fa-clock"></i> ${formatTime(event.start_time)} - ${formatTime(event.end_time)}</span>
              <span><i class="fas fa-users"></i> ${event.participation_strength_setlimit} Seats</span>
              <span><i class="fas fa-tag"></i> ${event.category_name}</span>
              <span><i class="fas fa-rupee-sign"></i> ₹${event.price}</span>
            </div>
          </div>
          <button class="register-button" onclick="showEventDetails('${event.eventid}')">
            Register Now
          </button>
        `;

        container.appendChild(eventTile);
      });
    }

    // Function to filter events by department
    function filterEvents(department) {
      fetchEvents(department);
      // Update active state in the side nav
      const navItems = document.querySelectorAll('.side-nav ul li');
      navItems.forEach(item => item.classList.remove('active'));
      const activeItem = Array.from(navItems).find(item => item.textContent.includes(department));
      if (activeItem) activeItem.classList.add('active');
    }

    // Function to show event details
    async function showEventDetails(eventId) {
      const loadingSpinner = document.getElementById('loading-spinner');
      loadingSpinner.style.display = 'block';

      try {
        const response = await fetch(`https://mindkraft25-backend.onrender.com/api/events/filter/?eventid=${eventId}`);
        const data = await response.json();

        if (data.status === 'success' && data.data.length > 0) {
          const event = data.data[0];
          document.getElementById('event-description').textContent = event.description;
          document.getElementById('event-prizes').textContent = event.prizes;
          document.getElementById('student-coordinator').textContent = event.studentCoordinator;
          document.getElementById('staff-coordinator').textContent = event.staffCoordinator;
          document.getElementById('contact-number').textContent = event.contactNumber;
          document.querySelector('.event-details h2').textContent = event.eventname;

          // Hide event tiles and show event details
          document.querySelector('.event-container').style.display = 'none';
          document.querySelector('.event-details').style.display = 'block';
        } else {
          alert('Event details not found');
        }
      } catch (error) {
        console.error('Error fetching event details:', error);
        alert('An error occurred while fetching event details.');
      } finally {
        loadingSpinner.style.display = 'none';
      }
    }

    // Function to hide event details and show event tiles
    function hideEventDetails() {
      document.querySelector('.event-container').style.display = 'flex';
      document.querySelector('.event-details').style.display = 'none';
    }

    // Function to format date to a readable format
    function formatDate(dateString) {
      const date = new Date(dateString);
      return `${date.getDate()}-${date.getMonth() + 1}-${date.getFullYear()}`;
    }

    // Function to format time to a readable format
    function formatTime(dateString) {
      const date = new Date(dateString);
      return `${date.getHours()}:${date.getMinutes()}`;
    }

    // Generate event tiles on page load by fetching events
    fetchEvents();
  </script>
</body>
</html>